---
import Base from '../../layouts/BaseLayout.astro';
import CalculatorsGrid from '../../components/CalculatorsGrid.astro';
import AdSlot from '../../components/AdSlot.astro';
import Faq from '../../components/FaqSchema.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';

const faqs = [
  { question: 'Qual a diferença entre juros simples e compostos?', answer: 'Nos simples, os juros incidem apenas sobre o capital inicial. Nos compostos, cada período soma juros ao principal, e os juros seguintes incidem sobre esse montante.' },
  { question: 'Como converter taxa mensal para anual?', answer: 'Simples: i_anual ≈ i_mensal × 12. Composta: (1 + i_mensal)^12 − 1.' },
  { question: 'O que é montante?', answer: 'É o total ao final do período: capital + juros.' },
  { question: 'Posso usar taxa com vírgula?', answer: 'Use ponto para decimais (ex.: 2,5% → 2.5), e informe a taxa no mesmo período do tempo t.' },
  { question: 'O resultado considera impostos/tarifas?', answer: 'Não. O cálculo é matemático. Para custos efetivos, inclua encargos do contrato.' },
];

---

<Base title="Calculadora de juros" description="Juros simples e compostos.">
  <Breadcrumbs />

  <h1 class="text-2xl font-semibold mb-4">Calculadora de juros</h1>

  <form id="form-juros" class="form-wrap grid gap-3">
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
      <label class="grid gap-1">
        <span>Capital (C)</span>
        <input id="c" type="number" inputmode="decimal" step="0.01" class="input border rounded p-2" placeholder="1000">
      </label>

      <label class="grid gap-1">
        <span>Taxa (%) por período</span>
        <input id="i" type="number" inputmode="decimal" step="0.0001" class="input border rounded p-2" placeholder="1.5">
      </label>

      <label class="grid gap-1">
        <span>Tempo (t)</span>
        <input id="t" type="number" step="1" class="input border rounded p-2" placeholder="12">
      </label>

      <label class="grid gap-1">
        <span>Tipo</span>
        <select id="tipo" class="input border rounded p-2">
          <option>Simples</option>
          <option>Compostos</option>
        </select>
      </label>
    </div>

    <button class="btn">Calcular</button>
  </form>

  <div id="saida" class="result"></div>

  <AdSlot slotId="6940589775" />

  <section class="prose dark:prose-invert mt-6">
    <h2>Fórmulas</h2>
    <ul>
      <li>Juros simples: <code>J = C × i × t</code></li>
      <li>Juros compostos: <code>M = C × (1 + i)<sup>t</sup></code></li>
    </ul>
  </section>

  <script is:inline>
    function format(n) {
      // formatação simples; ajuste para pt-PT/pt-BR se quiser com Intl.NumberFormat
      return Number(n).toFixed(2);
    }

    document.getElementById('form-juros').addEventListener('submit', (e) => {
      e.preventDefault();

      const C = parseFloat(document.getElementById('c').value);
      const i = parseFloat(document.getElementById('i').value) / 100; // taxa em decimal
      const t = parseInt(document.getElementById('t').value, 10);
      const tipo = document.getElementById('tipo').value;

      if ([C, i, t].some(v => isNaN(v)) || C <= 0 || t < 0) {
        document.getElementById('saida').textContent = 'Preencha os campos corretamente.';
        return;
      }

      let J, M, result;
      if (tipo === 'Simples') {
        J = C * i * t;
        M = C + J;
        result = `Juros: ${format(J)} | Montante: ${format(M)}`;
      } else {
        M = C * Math.pow(1 + i, t);
        J = M - C;
        result = `Juros: ${format(J)} | Montante: ${format(M)}`;
      }

      document.getElementById('saida').textContent = result;
    });
  </script>

  <section class="prose dark:prose-invert mt-6">
    <h2>Como calcular juros</h2>
    <p>Em <strong>juros simples</strong>, os juros aumentam linearmente: J = C × i × t, com montante M = C + J. Em <strong>juros compostos</strong>, cada período aplica a taxa sobre o montante acumulado: M = C × (1 + i)^t.</p>

    <h3>Exemplos</h3>
    <ul>
      <li><strong>Simples:</strong> C=1.000, i=2% ao mês, t=6 → J=120, M=1.120.</li>
      <li><strong>Compostos:</strong> C=1.000, i=2% ao mês, t=6 → M≈1.126,16; J≈126,16.</li>
    </ul>

    <h3>Dicas</h3>
    <p>Padronize o período (taxa e tempo em “mês” ou “ano”). Para comparar propostas, leve em conta CET, tarifas e impostos, além da taxa nominal.</p>
  </section>

  <Faq faqs={faqs} />

  <CalculatorsGrid current={Astro.url.pathname} />
  <AdSlot slotId="6940589775" />
</Base>
